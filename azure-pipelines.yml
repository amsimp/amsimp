trigger:
- master

pool:
  vmImage: 'macOS-10.15'

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.7.8'
- bash: echo "##vso[task.prependpath]$CONDA/bin"
  displayName: Add conda to PATH
- bash: sudo chown -R $USER $CONDA
  displayName: Take ownership of conda installation
- bash: conda create --yes --quiet --name myEnvironment
  displayName: Create Anaconda environment
- bash: |
    conda env create -f environment.yml && conda activate amsimp
    python setup.py install
  displayName: Install Anaconda packages
- task: PythonScript@0
  inputs:
    scriptSource: 'inline'
    script: |
      import amsimp

      state = amsimp.Dynamics(ai=False, forecast_length=6)

      state.simulate()

      state.exit()
