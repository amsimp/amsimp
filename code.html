
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Source Code &#8212; AMSIMP 0.3.7 documentation</title>
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Mathematics of AMSIMP" href="math.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="math.html" title="Mathematics of AMSIMP"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AMSIMP 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">Source Code</a><ul>
<li><a class="reference internal" href="#backend-class">Backend Class</a></li>
<li><a class="reference internal" href="#wind-class">Wind Class</a></li>
<li><a class="reference internal" href="#water-class">Water Class</a></li>
<li><a class="reference internal" href="#dynamics-class">Dynamics Class</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="math.html"
                        title="previous chapter">Mathematics of AMSIMP</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/code.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="index.html">Docs</a></li>
              
              <li>Source Code</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="source-code">
<h1>Source Code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="backend-class">
<h2>Backend Class<a class="headerlink" href="#backend-class" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">#cython: linetrace=True</span>
<span class="c">#distutils: define_macros=CYTHON_TRACE_NOGIL=1</span>
<span class="c">#cython: language_level=3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">AMSIMP Backend Class. For information about this class is described below.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

<span class="c"># Importing Dependencies</span>
<span class="k">import</span> <span class="nn">os</span>
<span class="k">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="k">import</span> <span class="nn">io</span>
<span class="k">import</span> <span class="nn">socket</span>
<span class="k">import</span> <span class="nn">wget</span>
<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="k">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span>
<span class="k">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">curve_fit</span>
<span class="k">from</span> <span class="nn">pynverse</span> <span class="k">import</span> <span class="n">inversefunc</span>
<span class="k">import</span> <span class="nn">requests</span>
<span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">cpython</span> <span class="k">cimport</span> <span class="nb">bool</span>
<span class="k">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">ticker</span>
<span class="k">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="k">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">r2_score</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>


<span class="k">cdef</span> <span class="k">class</span> <span class="nf">Backend</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AMSIMP Backend Class - This is the base class for AMSIMP, as such, all</span>
<span class="sd">    other classes within AMSIMP inherit this class, either directly or</span>
<span class="sd">    indirectly.</span>

<span class="sd">    For methods to be included in this class they must meet one of the following</span>
<span class="sd">    criteria:</span>
<span class="sd">    (1) they are considered essential components of the software.</span>
<span class="sd">    (2) the output of these methods are generated solely from the methods</span>
<span class="sd">    classified as (1).</span>
<span class="sd">    (3) these methods import data from the NRLMSISE-00 atmospheric model.</span>
<span class="sd">    This data is retrieved from the AMSIMP data repository, which is updated </span>
<span class="sd">    every hour.</span>
<span class="sd">    (4) they don&#39;t classify nicely into any other class.</span>
<span class="sd">    (5) they offer a visualisation of any of the methods found in this class.</span>

<span class="sd">    Below is a list of the methods included within this class, with a short</span>
<span class="sd">    description of their intended purpose and a bracketed number signifying</span>
<span class="sd">    which of the above criteria they meet. Please see the relevant class methods</span>
<span class="sd">    for more information. Please note that the unit information with AMSIMP</span>
<span class="sd">    is provided by the unit module within astropy.</span>

<span class="sd">    latitude_lines ~ generates a NumPy array of latitude lines (1). The unit</span>
<span class="sd">    of measurement is degrees.</span>
<span class="sd">    longitude_lines ~ generates a NumPy array of longitude lines (1). The unit</span>
<span class="sd">    of measurement is degrees.</span>
<span class="sd">    altitude_level ~ generates a NumPy array of altitude levels (1). The unit</span>
<span class="sd">    of measurement is metres.</span>

<span class="sd">    coriolis_parameter ~ generates a NumPy arrray of the Coriolis parameter (2).</span>
<span class="sd">    The unit of measurement is radians per second.</span>
<span class="sd">    gravitational_acceleration ~ generates a NumPy arrray of the gravitational</span>
<span class="sd">    acceleration (2). The unit of measurement is metres per second squared.</span>

<span class="sd">    temperature ~ outputs a NumPy array of temperature (3). The unit of</span>
<span class="sd">    measurement is Kelvin.</span>
<span class="sd">    density ~ outputs a NumPy array of atmospheric density (3). The unit of</span>
<span class="sd">    measurement is kilograms per cubic metre.</span>
<span class="sd">    </span>
<span class="sd">    pressure ~ outputs a NumPy array of atmospheric pressure (4). The unit of</span>
<span class="sd">    measurement is hectopascals (millibars).</span>
<span class="sd">    pressure_thickness ~ outputs a NumPy array of atmospheric pressure</span>
<span class="sd">    thickness (4). The unit of measurement is metres.</span>
<span class="sd">    potential_temperature ~ outputs a NumPy array of potential temperature (4).</span>
<span class="sd">    The unit of measurement is Kelvin.</span>
<span class="sd">    exner_function ~ outputs a NumPy array of the Exner function (4). This</span>
<span class="sd">    method has no unit of measurement, i.e. it is dimensionless.</span>
<span class="sd">    troposphere_boundaryline ~ generates a NumPy array of the</span>
<span class="sd">    troposphere - stratosphere boundary line (4). The unit of measurement is</span>
<span class="sd">    metres.</span>
<span class="sd">    </span>
<span class="sd">    longitude_contourf ~ generates a contour plot for a desired atmospheric</span>
<span class="sd">    process, with the axes being latitude, and longitude (5).</span>
<span class="sd">    altitude_contourf ~ generates a contour plot for a desired atmospheric</span>
<span class="sd">    process, with the axes being latitude, and altitude (5).</span>
<span class="sd">    pressure_thickness ~ generates a contour plot for pressure thickness,</span>
<span class="sd">    with the axes being latitude and longitude. This plot is then layed</span>
<span class="sd">    on top of a EckertIII global projection (5).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Define units of measurement for AMSIMP.</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

    <span class="c"># Current date.</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="c"># Predefined Constants.</span>
    <span class="c"># Angular rotation rate of Earth.</span>
    <span class="n">sidereal_day</span> <span class="o">=</span> <span class="p">((</span><span class="mf">23</span> <span class="o">+</span> <span class="p">(</span><span class="mf">56</span> <span class="o">/</span> <span class="mf">60</span><span class="p">))</span> <span class="o">*</span> <span class="mf">3600</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span>
    <span class="n">Upomega</span> <span class="o">=</span> <span class="p">((</span><span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">sidereal_day</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">rad</span>
    <span class="c"># Ideal Gas Constant</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">287</span> <span class="o">*</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">J</span> <span class="o">/</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>
    <span class="c"># Mean radius of the Earth.</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">R_earth</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
    <span class="c"># Universal Gravitational Constant.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">G</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">unit</span>
    <span class="c"># Mass of the Earth.</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">M_earth</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">value</span>  <span class="o">*</span> <span class="n">M</span><span class="o">.</span><span class="n">unit</span>
    <span class="c"># Molar mass of the Earth&#39;s air.</span>
    <span class="c"># m = 0.02896 (Unnecessary?)</span>
    <span class="c"># The specific heat capacity on a constant pressure surface for dry air.</span>
    <span class="n">c_p</span> <span class="o">=</span> <span class="mf">1004</span> <span class="o">*</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">J</span> <span class="o">/</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>
    <span class="c"># Gravitational acceleration at the Earth&#39;s surface.</span>
    <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">G</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">detail_level</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span> <span class="nb">int</span> <span class="n">forecast_days</span><span class="o">=</span><span class="mf">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The parameter, detail_level, is the numerical value for the level of</span>
<span class="sd">        computational detail that will be used in the mathematical calculations.</span>
<span class="sd">        This value is between 1 and 5. Defaults to a value of 3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Make detail_level available else where in the class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">=</span> <span class="n">detail_level</span>

        <span class="c"># Ensure self.detail_level is between 1 and 5.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">&gt;</span> <span class="mf">5</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;detail_level must be a positive integer between 1 and 5. The value of detail_level was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c"># Check for an internet connection.</span>
        <span class="k">def</span> <span class="nf">is_connected</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="s">&quot;www.github.com&quot;</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="mf">80</span><span class="p">),</span> <span class="mf">2</span><span class="p">)</span>
                <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_connected</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;You must connect to the internet in order to utilise AMSIMP.&quot;</span>
                <span class="o">+</span> <span class="s">&quot; Apologies for any inconvenience caused.&quot;</span>
            <span class="p">)</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">latitude_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of latitude lines.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">i</span>
        <span class="n">latitude_lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">i</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">90</span><span class="p">,</span> <span class="mf">91</span><span class="p">,</span> <span class="p">(</span><span class="mf">180</span> <span class="o">/</span> <span class="p">(</span><span class="mf">5</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3</span> <span class="o">-</span> <span class="mf">1</span><span class="p">))))</span>
            <span class="k">if</span> <span class="o">-</span><span class="mf">90</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mf">90</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="mf">0</span>
        <span class="p">]</span>
        
        <span class="c"># Remove the North and South Pole from the list.</span>
        <span class="k">del</span> <span class="n">latitude_lines</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">latitude_lines</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span>

        <span class="c"># Convert list to NumPy array and add the unit of measurement.</span>
        <span class="n">latitude_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">latitude_lines</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">deg</span>

        <span class="c"># Adjust array in accordance with the level of detail specified.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span>
            <span class="n">latitude_lines</span> <span class="o">=</span> <span class="n">latitude_lines</span><span class="p">[::</span><span class="mf">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span>
            <span class="n">latitude_lines</span> <span class="o">=</span> <span class="n">latitude_lines</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span>
            <span class="n">latitude_lines</span> <span class="o">=</span> <span class="n">latitude_lines</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">4</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>
            <span class="n">latitude_lines</span> <span class="o">=</span> <span class="n">latitude_lines</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">5</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">latitude_lines</span>
    
    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">longitude_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of longitude lines.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">longitude_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()</span> <span class="o">*</span> <span class="mf">2</span>

        <span class="k">return</span> <span class="n">longitude_lines</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">altitude_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of altitude levels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">max_height</span> <span class="o">=</span> <span class="mf">50000</span>
        <span class="n">mim_height_detail</span> <span class="o">=</span> <span class="n">max_height</span> <span class="o">/</span> <span class="mf">5</span>

        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">i</span>
        <span class="n">altitude_level</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">i</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="mf">0</span><span class="p">,</span> <span class="n">max_height</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="n">mim_height_detail</span> <span class="o">/</span> <span class="p">(</span><span class="mf">5</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">max_height</span>
        <span class="p">]</span>

        <span class="n">altitude_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">altitude_level</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span> <span class="n">altitude_level</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">coriolis_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy arrray of the Coriolis parameter at various latitudes</span>
<span class="sd">        of the Earth&#39;s surface. The Coriolis parameter is defined as two times</span>
<span class="sd">        the angular rotation of the Earth by the sin of the latitude you are</span>
<span class="sd">        interested in.</span>

<span class="sd">        Equation:</span>
<span class="sd">            f = 2 \* Upomega * sin(\phi)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coriolis_parameter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upomega</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()))</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">coriolis_parameter</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">gravitational_acceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy arrray of the effective gravitational acceleration</span>
<span class="sd">        according to WGS84 at a distance z from the Globe. The output is</span>
<span class="sd">        in the shape of (len(latitude_lines), len(altitude_level())). There</span>
<span class="sd">        is no longitudinal variation in gravitational accleration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">a</span> <span class="o">=</span> <span class="mf">6378137</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">b</span> <span class="o">=</span> <span class="mf">6356752.3142</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">g_e</span> <span class="o">=</span> <span class="mf">9.7803253359</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">g_p</span> <span class="o">=</span> <span class="mf">9.8321849378</span>

        <span class="c"># Magnitude of the effective gravitational acceleration according to WGS84</span>
        <span class="c"># at point P on the ellipsoid.</span>
        <span class="n">g_0</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">g_e</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">g_p</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">((</span><span class="n">a</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c"># Magnitude of the effective gravitational acceleration according to WGS84 at</span>
        <span class="c"># a distance z from the ellipsoid.</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">m</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Upomega</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">gravitational_acceleration</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">z</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">altitude</span><span class="p">:</span>
            <span class="n">g_z</span> <span class="o">=</span> <span class="n">g_0</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">1</span>
                <span class="o">-</span> <span class="p">(</span><span class="mf">2</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">f</span> <span class="o">+</span> <span class="n">m</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">z</span>
                <span class="o">+</span> <span class="p">(</span><span class="mf">3</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">g_z</span> <span class="o">=</span> <span class="n">g_z</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">gravitational_acceleration</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_z</span><span class="p">)</span>

        <span class="n">gravitational_acceleration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gravitational_acceleration</span><span class="p">)</span>
        <span class="n">gravitational_acceleration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">gravitational_acceleration</span><span class="p">)</span>
        <span class="n">gravitational_acceleration</span> <span class="o">*=</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">s</span> <span class="o">**</span> <span class="mf">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">gravitational_acceleration</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method imports temperature data from a NumPy file, which is</span>
<span class="sd">        located in the AMSIMP data repository on GitHub. The data</span>
<span class="sd">        stored within this repo is updated every six hours by amsimp-bot.</span>
<span class="sd">        Following which, it outputs a NumPy array in the shape of</span>
<span class="sd">        (len(longitude_lines), len(latitude_lines), len(altitude_level)).</span>

<span class="sd">        Temperature is defined as the mean kinetic energy density of molecular</span>
<span class="sd">        motion.</span>

<span class="sd">        I strongly recommend storing the output into a variable in order to</span>
<span class="sd">        prevent the need to repeatly download the file. For more information,</span>
<span class="sd">        visit https://github.com/amsimp/amsimp-data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># The url to the NumPy temperature file stored on the AMSIMP data repository.</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;https://github.com/amsimp/amsimp-data/raw/master/temperature.npy&quot;</span>

        <span class="c"># Download the NumPy file.</span>
        <span class="n">temperature_file</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="c"># Load and store the NumPy array into a variable.</span>
        <span class="n">temperature_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">temperature_file</span><span class="p">)</span>

        <span class="c"># Remove the NumPy file in order to prevent clutter.</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temperature_file</span><span class="p">)</span>
        
        <span class="c"># Adjust the temperature array in order to meet the level of detail specified.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">5</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature_array</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature_array</span><span class="p">[::</span><span class="mf">2</span><span class="p">,</span> <span class="p">::</span><span class="mf">2</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature_array</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">3</span><span class="p">,</span> <span class="mf">1</span><span class="p">::</span><span class="mf">3</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature_array</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">4</span><span class="p">,</span> <span class="mf">2</span><span class="p">::</span><span class="mf">4</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature_array</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">5</span><span class="p">,</span> <span class="mf">2</span><span class="p">::</span><span class="mf">5</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c"># Define the unit of measurement for temperature.</span>
        <span class="n">temperature</span> <span class="o">*=</span> <span class="n">units</span><span class="o">.</span><span class="n">K</span>
        <span class="k">return</span> <span class="n">temperature</span>
    
    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method imports atmospheric density data from a NumPy file, </span>
<span class="sd">        which is located in the AMSIMP data repository on GitHub. The data</span>
<span class="sd">        stored within this repo is updated every six hours by amsimp-bot.</span>
<span class="sd">        Following which, it outputs a NumPy array in the shape of</span>
<span class="sd">        (len(longitude_lines), len(latitude_lines), len(altitude_level)).</span>

<span class="sd">        The atmospheric density is the mass of the atmosphere per unit</span>
<span class="sd">        volume.</span>

<span class="sd">        I strongly recommend storing the output into a variable in order to</span>
<span class="sd">        prevent the need to repeatly download the file. For more information,</span>
<span class="sd">        visit https://github.com/amsimp/amsimp-data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># The url to the NumPy density file stored on the AMSIMP data repository.</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;https://github.com/amsimp/amsimp-data/raw/master/density.npy&quot;</span>

        <span class="c"># Download the NumPy file.</span>
        <span class="n">density_file</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="c"># Load and store the NumPy array into a variable.</span>
        <span class="n">density_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">density_file</span><span class="p">)</span>

        <span class="c"># Remove the NumPy file in order to prevent clutter.</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">density_file</span><span class="p">)</span>
        
        <span class="c"># Adjust the density array in order to meet the level of detail specified.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">5</span><span class="p">:</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">density_array</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">density_array</span><span class="p">[::</span><span class="mf">2</span><span class="p">,</span> <span class="p">::</span><span class="mf">2</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">density_array</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">3</span><span class="p">,</span> <span class="mf">1</span><span class="p">::</span><span class="mf">3</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">density_array</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">4</span><span class="p">,</span> <span class="mf">2</span><span class="p">::</span><span class="mf">4</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">density_array</span><span class="p">[</span><span class="mf">2</span><span class="p">::</span><span class="mf">5</span><span class="p">,</span> <span class="mf">2</span><span class="p">::</span><span class="mf">5</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c"># Define the unit of measurement for atmospheric density.</span>
        <span class="n">density</span> <span class="o">*=</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">kg</span> <span class="o">/</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">**</span> <span class="mf">3</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">density</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of atmospheric pressure utilising the Ideal</span>
<span class="sd">        Gas Law. The ideal gas equation is the equation of state for the</span>
<span class="sd">        atmosphere, and is defined as an equation relating temperature,</span>
<span class="sd">        pressure, and specific volume of a system in theromodynamic</span>
<span class="sd">        equilibrium.</span>

<span class="sd">        Equation:</span>
<span class="sd">            p = rho \* R * T</span>

<span class="sd">        Pressure is defined as the flux of momentum component normal to a given</span>
<span class="sd">        surface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span>

        <span class="n">pressure</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">hPa</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pressure</span>
    
    <span class="k">cpdef</span> <span class="nf">fit_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is solely utilised for non-linear regression in the</span>
<span class="sd">        amsimp.Backend.pressure_thickness() method. Please do not</span>
<span class="sd">        interact with the method directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure_thickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="mf">1000</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">500</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of atmospheric pressure thickness</span>
<span class="sd">        between two constant pressure surfaces, p1 and p2, using</span>
<span class="sd">        non-linear regression. Non-linear regression is when</span>
<span class="sd">        emperical data is modelled by a selected non-linear</span>
<span class="sd">        function. The equation of the function utilised by this</span>
<span class="sd">        method is below. The method will generate an exception</span>
<span class="sd">        if the R^2 value is less than 0.99. Note: p1 must be</span>
<span class="sd">        greater than p2. The default p1 value is 1000 hPa and</span>
<span class="sd">        the default p2 value is 500 hPa.</span>

<span class="sd">        Equation:</span>
<span class="sd">            y = a - frac{b}{c} * (1 - \exp(-c * x))</span>

<span class="sd">        Pressure thickness is defined as the distance between two</span>
<span class="sd">        pressure surfaces.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure p1 is greater than p2.</span>
        <span class="k">if</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="n">p2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Please note that p1 must be greater than p2.&quot;</span><span class="p">)</span>

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>

        <span class="c"># Find the nearest constant pressure surface to p1 and p2 in pressure.</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">indx_p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">indx_p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Find the approximate altitude of the constant pressure surfaces</span>
        <span class="c"># p1 and p2. Following which, take away 5400 from the p1 values </span>
        <span class="c"># and add 1000 to the p2 value.</span>
        <span class="n">approx_p1_alt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="n">indx_p1</span><span class="p">]</span>
        <span class="n">approx_p2_alt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="n">indx_p2</span><span class="p">]</span>
        <span class="n">approx_p1_alt</span> <span class="o">-=</span> <span class="mf">5400</span>
        <span class="n">approx_p2_alt</span> <span class="o">+=</span> <span class="mf">2000</span>

        <span class="n">indx_p1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">approx_p1_alt</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="n">indx_p2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">approx_p2_alt</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span> 

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="n">indx_p1</span><span class="p">:</span><span class="n">indx_p2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">p</span><span class="p">,</span> <span class="nf">p_lat</span><span class="p">,</span> <span class="nf">abc</span><span class="p">,</span> <span class="nf">predicted_pressure</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_pressurethickness</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">r_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1000</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">pthickness_lat</span>
        <span class="k">cdef</span> <span class="kt">tuple</span> <span class="nf">c</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">p1_height</span><span class="p">,</span> <span class="nf">p2_height</span><span class="p">,</span> <span class="nf">pthickness</span><span class="p">,</span> <span class="nf">r_value</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure</span><span class="p">:</span>
            <span class="n">pthickness_lat</span> <span class="o">=</span>  <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p_lat</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">p_lat</span> <span class="o">=</span> <span class="n">p_lat</span><span class="p">[</span><span class="n">indx_p1</span><span class="p">:</span><span class="n">indx_p2</span><span class="p">]</span>

                <span class="n">c</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">p_lat</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>
                <span class="n">abc</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>

                <span class="n">predicted_pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">(</span>
                    <span class="n">altitude</span><span class="p">,</span> <span class="n">abc</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">r_value</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
                    <span class="n">predicted_pressure</span><span class="p">,</span> <span class="n">p_lat</span>
                <span class="p">)</span>
                <span class="n">r_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>

                <span class="n">inverse_fitmethod</span> <span class="o">=</span> <span class="n">inversefunc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">,</span>
                    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">abc</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span>
                <span class="p">)</span>

                <span class="n">p1_height</span> <span class="o">=</span> <span class="n">inverse_fitmethod</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
                <span class="n">p2_height</span> <span class="o">=</span> <span class="n">inverse_fitmethod</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
                <span class="n">pthickness</span> <span class="o">=</span> <span class="n">p2_height</span> <span class="o">-</span> <span class="n">p1_height</span>

                <span class="n">pthickness_lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pthickness</span><span class="p">)</span>
            <span class="n">list_pressurethickness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pthickness_lat</span><span class="p">)</span>
        
        <span class="c"># Ensure the R^2 value is greater than 0.99.</span>
        <span class="n">r_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r_value</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Unable to determine the pressure thickness&quot;</span>
            <span class="o">+</span> <span class="s">&quot; at this time. Please contact the developer for futher&quot;</span>
            <span class="o">+</span> <span class="s">&quot; assistance.&quot;</span><span class="p">)</span>
        
        <span class="n">pressure_thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_pressurethickness</span><span class="p">)</span>
        <span class="n">pressure_thickness</span> <span class="o">*=</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span> <span class="n">pressure_thickness</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">potential_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of potential temperature. The potential</span>
<span class="sd">        temperature of a parcel of fluid at pressure P is the temperature that</span>
<span class="sd">        the parcel would attain if adiabatically brought to a standard reference</span>
<span class="sd">        pressure</span>

<span class="sd">        Equation:</span>
<span class="sd">            theta = T \* (frac{P}{P_0}) ** (-R / c_p)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">R</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">c_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_p</span><span class="o">.</span><span class="n">value</span>

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">array_potentialtemperature</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_potentialtemperature</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">p_temp</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">len_pressure</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_pressure</span><span class="p">:</span>
            <span class="n">array_potentialtemperature</span> <span class="o">=</span> <span class="n">temperature</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">pressure</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">n</span><span class="p">]</span> <span class="o">/</span> <span class="n">pressure</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="n">R</span> <span class="o">/</span> <span class="n">c_p</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">p_temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">array_potentialtemperature</span><span class="p">)</span>

            <span class="n">list_potentialtemperature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_temp</span><span class="p">)</span>

            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
        
        <span class="n">potential_temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_potentialtemperature</span><span class="p">)</span>
        <span class="n">potential_temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">potential_temperature</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span>
        <span class="n">potential_temperature</span> <span class="o">*=</span> <span class="n">units</span><span class="o">.</span><span class="n">K</span>
        <span class="k">return</span> <span class="n">potential_temperature</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">exner_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of the exner function. The Exner function can be</span>
<span class="sd">        viewed as non-dimensionalized pressure.</span>

<span class="sd">        Equation:</span>
<span class="sd">            \Pi = frac{T}{theta}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">potential_temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential_temperature</span><span class="p">()</span>

        <span class="n">exner_function</span> <span class="o">=</span> <span class="n">temperature</span> <span class="o">/</span> <span class="n">potential_temperature</span>

        <span class="k">return</span> <span class="n">exner_function</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">troposphere_boundaryline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of the troposphere - stratosphere</span>
<span class="sd">        boundary line in the shape (len(longitude_lines), len(latitude_lines).</span>
<span class="sd">        This is calculated by looking at the vertical temperature profile in</span>
<span class="sd">        the method, amsimp.Backend.temperature().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="n">grad_temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">gradient_temperature</span> <span class="o">=</span> <span class="n">grad_temperature</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>

        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">trop_strat_line</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">lat_trop_strat_line</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temp</span><span class="p">,</span> <span class="nf">t</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">t_n</span><span class="p">,</span> <span class="nf">alt</span>
        <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">gradient_temperature</span><span class="p">:</span>
            <span class="n">lat_trop_strat_line</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mf">0</span>
                <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
                    <span class="n">t_n</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span>
                        <span class="n">alt</span> <span class="o">=</span> <span class="n">altitude</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                        <span class="n">lat_trop_strat_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
                        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
            <span class="n">trop_strat_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lat_trop_strat_line</span><span class="p">)</span>

        <span class="n">troposphere_boundaryline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">trop_strat_line</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span> <span class="n">troposphere_boundaryline</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

    <span class="k">def</span> <span class="nf">longitude_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots a desired atmospheric process on a contour plot, with the axes</span>
<span class="sd">        being latitude and longitude. This plot is then layed on top of a </span>
<span class="sd">        EckertIII global projection. For the raw data, please see the other</span>
<span class="sd">        methods found in this class.</span>

<span class="sd">        For a temperature contour plot, the value of which is 0.</span>
<span class="sd">        For a pressure contour plot, the value of which is 1.</span>
<span class="sd">        For a density contour plot, the value of which is 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s">&quot; For a temperature contour plot, the value of which is 0. &quot;</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot;For a pressure contour plot, the value of which is 1. For a &quot;</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot;density contour plot, the value of which is 2.&quot;</span>

        <span class="c"># Ensure, which, is a number between 0 and 2.</span>
        <span class="k">if</span> <span class="n">which</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">which</span> <span class="o">&gt;</span> <span class="mf">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;which must be a natural number between 0 and 2. The value of which was: {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">which</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">info</span>
            <span class="p">)</span>
        
        <span class="c"># Ensure, which, is a integer.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;which must be a natural number between 0 and 2. The value of which was: {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">which</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">info</span>
            <span class="p">)</span>

        <span class="c"># Ensure alt is between 0 and 50000 metres above sea level.</span>
        <span class="k">if</span> <span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">alt</span> <span class="o">&gt;</span> <span class="mf">50000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;alt must be a real number between 0 and 50,000. The value of alt was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">alt</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c"># Index of the nearest alt in amsimp.Backend.altitude_level()</span>
        <span class="n">indx_alt</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">alt</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        
        <span class="c"># Defines the axes, and the data.</span>
        <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">indx_alt</span><span class="p">]</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="s">&quot;Temperature&quot;</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="s">&quot; (K)&quot;</span>
        <span class="k">elif</span> <span class="n">which</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">indx_alt</span><span class="p">]</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="s">&quot;Atmospheric Pressure&quot;</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="s">&quot; (hPa)&quot;</span>
        <span class="k">elif</span> <span class="n">which</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">indx_alt</span><span class="p">]</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="s">&quot;Atmospheric Density&quot;</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="s">&quot; ($</span><span class="se">\\</span><span class="s">frac{kg}{m^3}$)&quot;</span>

        <span class="c"># EckertIII projection details.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

        <span class="c"># Contourf plotting.</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
        <span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">longitude</span><span class="p">,</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
            <span class="n">data_type</span> <span class="o">+</span> <span class="s">&quot; (&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, Altitude = &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="n">indx_alt</span><span class="p">])</span> <span class="o">+</span><span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Colorbar creation.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
            <span class="n">data_type</span> <span class="o">+</span> <span class="n">unit</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">altitude_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">central_long</span><span class="o">=-</span><span class="mf">7.6921</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots a desired atmospheric process on a contour plot,</span>
<span class="sd">        with the axes being latitude, and altitude. For the raw</span>
<span class="sd">        data, please see the other methods found in this class.</span>
<span class="sd">        If you would like a particular atmospheric process to</span>
<span class="sd">        be added to this method, either create an issue on</span>
<span class="sd">        GitHub or send an email to support@amsimp.com.</span>

<span class="sd">        For a temperature contour plot, the value of which is 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s">&quot; For a temperature contour plot, the value of which is 0. &quot;</span>

        <span class="c"># Ensure, which, is equal to 0.</span>
        <span class="k">if</span> <span class="n">which</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">which</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;which must be equal to zero. The value of which was: {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">which</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">info</span>
            <span class="p">)</span>
        
        <span class="c"># Ensure, which, is a integer.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;which must be equal to zero. The value of which was: {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">which</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">info</span>
            <span class="p">)</span>
        
        <span class="c"># Ensure central_long is between -180 and 180.</span>
        <span class="k">if</span> <span class="n">central_long</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">180</span> <span class="ow">or</span> <span class="n">central_long</span> <span class="o">&gt;</span> <span class="mf">180</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;central_long must be a real number between -180 and 180. The value of central_long was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">central_long</span>
                <span class="p">)</span>
            <span class="p">)</span>
        
        <span class="c"># Index of the nearest central_long in amsimp.Backend.longtitude_lines()</span>
        <span class="n">indx_long</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">central_long</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Defines the axes, and the data.</span>
        <span class="n">latitude</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">())</span>
        
        <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()[</span><span class="n">indx_long</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="s">&quot;Temperature&quot;</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="s">&quot; (K)&quot;</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>

        <span class="c"># Contourf plotting.</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">altitude</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Altitude (m)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
            <span class="n">data_type</span> <span class="o">+</span> <span class="s">&quot; (&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, Longitude = &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="n">indx_long</span><span class="p">],</span> <span class="mf">2</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Colorbar creation.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
            <span class="n">data_type</span> <span class="o">+</span> <span class="n">unit</span>
        <span class="p">)</span>

        <span class="c"># Average boundary line between the troposphere and the stratosphere.</span>
        <span class="n">troposphere_boundaryline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troposphere_boundaryline</span><span class="p">()</span>
        <span class="n">avg_tropstratline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="c"># Plot average boundary line on the contour plot.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">latitude</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span>
            <span class="n">avg_tropstratline</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s">&quot;Troposphere - Stratosphere Boundary Line&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">pressurethickness_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots pressure thickness on a contour plot, with the axes being</span>
<span class="sd">        latitude and longitude. This plot is then layed on top of a EckertIII</span>
<span class="sd">        global projection. For the raw data, please use the</span>
<span class="sd">        amsimp.Backend.pressure_thickness() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Defines the axes, and the data.</span>
        <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure_thickness</span><span class="p">()</span>

        <span class="c"># EckertIII projection details.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

        <span class="c"># Contourf plotting.</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">pressure_thickness</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">pressure_thickness</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
        <span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">longitude</span><span class="p">,</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">pressure_thickness</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c"># Index of the rain / snow line</span>
        <span class="n">indx_snowline</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">levels</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">5400</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="n">contour</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="n">indx_snowline</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">contour</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="n">indx_snowline</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span> 

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Pressure Thickness (&quot;</span>
         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Colorbar creation.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Pressure Thickness (1000 hPa - 500 hPa) (m)&quot;</span><span class="p">)</span>

        <span class="c"># Footnote</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span>
            <span class="mf">0.99</span><span class="p">,</span>
            <span class="mf">0.01</span><span class="p">,</span>
            <span class="s">&quot;Rain / Snow Line is marked by the black line (5,400 m).&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="wind-class">
<h2>Wind Class<a class="headerlink" href="#wind-class" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">#cython: linetrace=True</span>
<span class="c">#distutils: define_macros=CYTHON_TRACE_NOGIL=1</span>
<span class="c">#cython: language_level=3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">AMSIMP Wind Class. For information about this class is described below.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

<span class="c"># Importing Dependencies</span>
<span class="k">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="k">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">ticker</span>
<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">amsimp.backend</span> <span class="k">cimport</span> <span class="n">Backend</span>
<span class="k">from</span> <span class="nn">amsimp.backend</span> <span class="k">import</span> <span class="n">Backend</span>
<span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

<span class="k">cdef</span> <span class="k">class</span> <span class="nf">Wind</span><span class="p">(</span><span class="n">Backend</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AMSIMP Wind Class - This class is concerned with calculating numerical</span>
<span class="sd">    values for wind, specifically geostrophic wind, in the troposphere and the</span>
<span class="sd">    stratosphere. It also contain two methods for the visualisation of these</span>
<span class="sd">    numerical values.</span>

<span class="sd">    Below is a list of the methods included within this class, with a short</span>
<span class="sd">    description of their intended purpose. Please see the relevant class methods</span>
<span class="sd">    for more information.</span>

<span class="sd">    zonal_wind ~ outputs the zonal component of geostrophic wind.</span>
<span class="sd">    meridional_wind ~ outputs the meridional component of geostrophic wind.</span>
<span class="sd">    wind_contourf ~ generates a geostrophic wind contour plot.</span>
<span class="sd">    globe ~ generates a geostrophic wind contour plot, adds wind vectors to</span>
<span class="sd">    that said plot, and overlays both on a Nearside Projection of the Earth.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">zonal_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method outputs the zonal component of geostrophic wind, in</span>
<span class="sd">        the shape of (len(longitude_lines), len(latitude_lines),</span>
<span class="sd">        len(altitude_level)). </span>
<span class="sd">        </span>
<span class="sd">        Geostrophic wind is a theoretical wind that is a result of a perfect</span>
<span class="sd">        balance between the Coriolis force and the pressure gradient force.</span>
<span class="sd">        This balance is known as geostrophic balance. </span>

<span class="sd">        Equation:</span>
<span class="sd">            u_g = -frac{1}{rho * f} \* frac{\partial p}{\partial y}</span>
<span class="sd">        </span>
<span class="sd">        Note: Geostrophic balance does not hold near the equator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensures that the detail_level must be higher than 2 in order to utilise this method.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">&lt;</span> <span class="mf">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;detail_level must be greater than 2 in order to utilise this method.&quot;</span>
            <span class="p">)</span>

        <span class="c"># Distance of one degree of latitude (e.g. 0N - 1N/1S), measured in metres.</span>
        <span class="k">cdef</span> <span class="nf">lat_d</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mf">360</span>
        <span class="c"># Distance between latitude lines in the class method, </span>
        <span class="c"># amsimp.Backend.latitude_lines().</span>
        <span class="k">cdef</span> <span class="nf">delta_y</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">lat_d</span>
        <span class="n">delta_y</span> <span class="o">*=</span> <span class="mf">2</span>

        <span class="c"># Gradient of geopotential height over latitudinal distance.</span>
        <span class="n">pressure_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">())</span>
        <span class="n">pressure_gradient</span> <span class="o">=</span> <span class="n">pressure_gradient</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressuregradient_deltay</span> <span class="o">=</span> <span class="n">pressure_gradient</span> <span class="o">/</span> <span class="n">delta_y</span>

        <span class="c"># Defining a 3D coriolis parameter NumPy array.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">coriolis_parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coriolis_parameter</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">f_alt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_altitude</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">coriolis_parameter</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len_altitude</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_coriolisparameter</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_longitudelines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">())</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_longitudelines</span><span class="p">:</span>
            <span class="n">list_coriolisparameter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_alt</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
        <span class="n">coriolis_parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_coriolisparameter</span><span class="p">)</span>
        <span class="n">coriolis_parameter</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span>

        <span class="c"># Geostrophic wind calculation (zonal component).</span>
        <span class="n">zonal_wind</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="p">(</span><span class="mf">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">()</span> <span class="o">*</span> <span class="n">coriolis_parameter</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">pressuregradient_deltay</span>
        <span class="p">)</span>

        <span class="c"># Convert zonal wind to metres per second.</span>
        <span class="n">zonal_wind</span> <span class="o">=</span> <span class="n">zonal_wind</span><span class="o">.</span><span class="n">si</span>

        <span class="k">return</span> <span class="n">zonal_wind</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">meridional_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method outputs the meridional component of geostrophic wind, in</span>
<span class="sd">        the shape of (len(longitude_lines), len(latitude_lines),</span>
<span class="sd">        len(altitude_level)). </span>
<span class="sd">        </span>
<span class="sd">        Geostrophic wind is a theoretical wind that is a result of a perfect</span>
<span class="sd">        balance between the Coriolis force and the pressure gradient force.</span>
<span class="sd">        This balance is known as geostrophic balance.</span>

<span class="sd">        Equation:</span>
<span class="sd">            v_g = frac{1}{rho * f} \* frac{\partial p}{\partial y} </span>
<span class="sd">        </span>
<span class="sd">        Note: Geostrophic balance does not hold near the equator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensures that the detail_level must be higher than 2 in order to utilise this method.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">&lt;</span> <span class="mf">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;detail_level must be greater than 2 in order to utilise this method.&quot;</span>
            <span class="p">)</span>

        <span class="c"># Distance between longitude lines at the equator.</span>
        <span class="k">cdef</span> <span class="nf">eq_longd</span> <span class="o">=</span> <span class="mf">111.19</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">km</span>
        <span class="n">eq_longd</span> <span class="o">=</span> <span class="n">eq_longd</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="c"># Distance of one degree of longitude (e.g. 0W - 1W/1E), measured in metres.</span>
        <span class="c"># The distance between two lines of longitude is not constant.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">long_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">())</span> <span class="o">*</span> <span class="n">eq_longd</span>
        <span class="c"># Distance between latitude lines in the class method, amsimp.Backend.latitude_lines().</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">delta_x</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">long_d</span>
        
        <span class="c"># Defining a 3D longitudinal distance NumPy array.</span>
        <span class="n">delta_x</span> <span class="o">=</span> <span class="n">delta_x</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">long_alt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_altitude</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_x</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len_altitude</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">long_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_deltax</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_longitudelines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">())</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_longitudelines</span><span class="p">:</span>
            <span class="n">list_deltax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">long_alt</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
        <span class="n">delta_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_deltax</span><span class="p">)</span>
        <span class="n">delta_x</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span>
        <span class="n">delta_x</span> <span class="o">*=</span> <span class="mf">2</span>

        <span class="c"># Gradient of geopotential height over latitudinal distance.</span>
        <span class="n">pressure_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">())</span>
        <span class="n">pressure_gradient</span> <span class="o">=</span> <span class="n">pressure_gradient</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressuregradient_deltax</span> <span class="o">=</span> <span class="n">pressure_gradient</span> <span class="o">/</span> <span class="n">delta_x</span>

        <span class="c"># Defining a 3D coriolis parameter NumPy array.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">coriolis_parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coriolis_parameter</span><span class="p">()</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">f_alt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">coriolis_parameter</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len_altitude</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_coriolisparameter</span> <span class="o">=</span> <span class="p">[]</span>      
        <span class="n">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_longitudelines</span><span class="p">:</span>
            <span class="n">list_coriolisparameter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_alt</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
        <span class="n">coriolis_parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_coriolisparameter</span><span class="p">)</span>
        <span class="n">coriolis_parameter</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span>

        <span class="c"># Geostrophic wind calculation (meridional component).</span>
        <span class="n">meridional_wind</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">()</span> <span class="o">*</span> <span class="n">coriolis_parameter</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">pressuregradient_deltax</span>
        <span class="p">)</span>

        <span class="c"># Convert meridional wind to metres per second.</span>
        <span class="n">meridional_wind</span> <span class="o">=</span> <span class="n">meridional_wind</span><span class="o">.</span><span class="n">si</span>

        <span class="k">return</span> <span class="n">meridional_wind</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

    <span class="k">def</span> <span class="nf">wind_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_wind</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">central_long</span><span class="o">=-</span><span class="mf">7.6921</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For zonal (geostrophic) wind, set which_wind to 0.</span>
<span class="sd">        For meridional (geostrophic) wind, set which_wind to 1.</span>
<span class="sd">        </span>
<span class="sd">        Generates a geostrophic wind contour plot, with the axes being</span>
<span class="sd">        latitude, and longitude.</span>
<span class="sd">        </span>
<span class="sd">        For the raw data, please use the</span>
<span class="sd">        amsimp.Wind.geostrophic_wind() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure central_long is between -180 and 180.</span>
        <span class="k">if</span> <span class="n">central_long</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">180</span> <span class="ow">or</span> <span class="n">central_long</span> <span class="o">&gt;</span> <span class="mf">180</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;central_long must be a real number between -180 and 180. The value of central_long was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">central_long</span>
                <span class="p">)</span>
            <span class="p">)</span>
        
        <span class="c"># Index of the nearest central_long in amsimp.Backend.longtitude_lines()</span>
        <span class="n">indx_long</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">central_long</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        
        <span class="c"># Set geostrophic wind to either the zonal, or meridional component.</span>
        <span class="k">if</span> <span class="n">which_wind</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
            <span class="n">geostrophic_wind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonal_wind</span><span class="p">()[</span><span class="n">indx_long</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="n">wind_type</span> <span class="o">=</span> <span class="s">&quot;Zonal&quot;</span>
        <span class="k">elif</span> <span class="n">which_wind</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>
            <span class="n">geostrophic_wind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meridional_wind</span><span class="p">()[</span><span class="n">indx_long</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="n">wind_type</span> <span class="o">=</span> <span class="s">&quot;Meridional&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;which_wind must be equal to either zero or one. The value of which_wind was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">which_wind</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c"># Defines the axes, and the data.</span>
        <span class="n">latitude</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">())</span>
        <span class="n">geostrophic_wind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">geostrophic_wind</span><span class="p">)</span>

        <span class="c"># Specifies the contour levels</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">geostrophic_wind</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">geostrophic_wind</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>

        <span class="c"># Contour plotting.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">geostrophic_wind</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;jet&quot;</span><span class="p">)</span>

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Altitude (m)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">wind_type</span> <span class="o">+</span> <span class="s">&quot; Wind Contour Plot (&quot;</span>
         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, Longitude = &quot;</span>
         <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="n">indx_long</span><span class="p">],</span> <span class="mf">2</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Footnote</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span>
            <span class="mf">0.99</span><span class="p">,</span>
            <span class="mf">0.01</span><span class="p">,</span>
            <span class="s">&quot;Note: Geostrophic balance does not hold near the equator.&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.135</span><span class="p">)</span>

        <span class="c"># Colorbar creation.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Velocity ($</span><span class="se">\\</span><span class="s">frac{m}{s}$)&quot;</span><span class="p">)</span>

        <span class="c"># Average boundary line between the troposphere and the stratosphere.</span>
        <span class="n">troposphere_boundaryline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troposphere_boundaryline</span><span class="p">()</span>
        <span class="n">avg_tropstratline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="c"># Plot average boundary line on the contour plot.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">latitude</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span>
            <span class="n">avg_tropstratline</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s">&quot;Troposphere - Stratosphere Boundary Line&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">globe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_lat</span><span class="o">=</span><span class="mf">53.1424</span><span class="p">,</span> <span class="n">central_long</span><span class="o">=-</span><span class="mf">7.6921</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similiar to amsimp.Wind.wind_contourf(), however, this particular method</span>
<span class="sd">        adds wind vectors to the contour plot. It also overlays both of these</span>
<span class="sd">        elements onto a Nearside Perspective projection of the Earth.</span>

<span class="sd">        By default, the perspective view is looking directly down at the city</span>
<span class="sd">        of Dublin in the country of Ireland.</span>

<span class="sd">        Note:</span>
<span class="sd">        The NumPy method, seterr, is used to suppress a weird RunTime warning</span>
<span class="sd">        error that occurs on certain detail_level values in certain months.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure central_lat is between -90 and 90.</span>
        <span class="k">if</span> <span class="n">central_lat</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">90</span> <span class="ow">or</span> <span class="n">central_lat</span> <span class="o">&gt;</span> <span class="mf">90</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;central_lat must be a real number between -90 and 90. The value of central_lat was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">central_lat</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c"># Ensure central_long is between -180 and 180.</span>
        <span class="k">if</span> <span class="n">central_long</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">180</span> <span class="ow">or</span> <span class="n">central_long</span> <span class="o">&gt;</span> <span class="mf">180</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;central_long must be a real number between -180 and 180. The value of central_long was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">central_long</span>
                <span class="p">)</span>
            <span class="p">)</span>
        
        <span class="c"># Ensure alt is between 0 and 50000 metres above sea level.</span>
        <span class="k">if</span> <span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">alt</span> <span class="o">&gt;</span> <span class="mf">50000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;alt must be a real number between 0 and 50,000. The value of alt was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">alt</span>
                <span class="p">)</span>
            <span class="p">)</span>
        
        <span class="c"># Index of the nearest alt in amsimp.Backend.altitude_level()</span>
        <span class="n">indx_alt</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">alt</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Ignore NumPy errors.</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="c"># Define the axes, and the data.</span>
        <span class="n">latitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">longitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">latitude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">89.99</span><span class="p">)</span>
        <span class="n">latitude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">89.99</span><span class="p">)</span>
        <span class="n">longitude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">179.99</span><span class="p">)</span>
        <span class="n">longitude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">179.99</span><span class="p">)</span>
        <span class="n">latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">latitude</span><span class="p">))</span>
        <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">longitude</span><span class="p">))</span>
        
        <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span><span class="n">longitude</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonal_wind</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">indx_alt</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meridional_wind</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">indx_alt</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
            <span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
            <span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span>
        <span class="n">u</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="n">u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span>
        <span class="n">v</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">u_norm</span> <span class="o">=</span> <span class="n">u</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="n">v</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span>
        <span class="n">v_norm</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="n">v</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span>

        <span class="n">geostrophic_wind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="n">v</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span>
            <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NearsidePerspective</span><span class="p">(</span>
                <span class="n">central_longitude</span><span class="o">=</span><span class="n">central_long</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">central_lat</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Add latitudinal and longitudinal grid lines, as well as, </span>
        <span class="c"># coastlines to the globe.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

        <span class="c"># Contour plotting.</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">geostrophic_wind</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">geostrophic_wind</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>

        <span class="n">contourf</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">longitude</span><span class="p">,</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">geostrophic_wind</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c"># Add geostrophic wind vectors.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
            <span class="n">longitude</span><span class="p">,</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">u_norm</span><span class="p">,</span>
            <span class="n">v_norm</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>   
        <span class="p">)</span>

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Geostrophic Wind (&quot;</span>
         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, Altitude = &quot;</span>
         <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="n">indx_alt</span><span class="p">])</span> <span class="o">+</span><span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Add colorbar.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Velocity ($</span><span class="se">\\</span><span class="s">frac{m}{s}$)&quot;</span><span class="p">)</span>

        <span class="c"># Footnote</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span>
            <span class="mf">0.99</span><span class="p">,</span>
            <span class="mf">0.01</span><span class="p">,</span>
            <span class="s">&quot;Note: Geostrophic balance does not hold near the equator.&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="water-class">
<h2>Water Class<a class="headerlink" href="#water-class" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">#cython: linetrace=True</span>
<span class="c">#distutils: define_macros=CYTHON_TRACE_NOGIL=1</span>
<span class="c">#cython: language_level=3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">AMSIMP Precipitable Water Class. For information about this class is described below.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

<span class="c"># Importing Dependencies</span>
<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">quad</span>
<span class="k">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="k">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">ticker</span>
<span class="k">from</span> <span class="nn">amsimp.wind</span> <span class="k">cimport</span> <span class="n">Wind</span>
<span class="k">from</span> <span class="nn">amsimp.wind</span> <span class="k">import</span> <span class="n">Wind</span>
<span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">cpython</span> <span class="k">cimport</span> <span class="nb">bool</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>


<span class="k">cdef</span> <span class="k">class</span> <span class="nf">Water</span><span class="p">(</span><span class="n">Wind</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AMSIMP Water Class - This class is concerned with calculating how much</span>
<span class="sd">    precipitable water vapor is in the air at a given latitude. Considering</span>
<span class="sd">    stratospheric air can be approximated as dry, to a reasonable degree of</span>
<span class="sd">    accuracy, this class will only consider tropospheric air.</span>

<span class="sd">    vapor_pressure ~ generates a NumPy array of saturated vapor pressure.</span>
<span class="sd">    precipitable_water ~ generates a NumPy array of saturated precipitable water</span>
<span class="sd">    vapor.</span>
<span class="sd">    water_contourf ~ generates a precipitable water vapor contour plot, and</span>
<span class="sd">    overlays that said plot onto a EckertIII projection of the Earth.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">vapor_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of saturated vapor pressure. Vapor pressure, in</span>
<span class="sd">        meteorology, is the partial pressure of water vapor. The partial</span>
<span class="sd">        pressure of water vapor is the pressure that water vapor contributes</span>
<span class="sd">        to the total atmospheric pressure.</span>

<span class="sd">        Equation:</span>
<span class="sd">            e = 6.112 \* \exp((17.67 * T) / (T + 243.15))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensures that the detail_level must be higher than 2 in order to utilise this method.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_level</span> <span class="o">&lt;</span> <span class="mf">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;detail_level must be greater than 2 in order to utilise this method.&quot;</span>
            <span class="p">)</span>
        
        <span class="c"># Average boundary line between the troposphere and the stratosphere.</span>
        <span class="n">troposphere_boundaryline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troposphere_boundaryline</span><span class="p">()</span>
        <span class="n">avg_tropstratline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">)</span>
        <span class="n">idx_troposphereboundaryline</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">avg_tropstratline</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Convert temperature in Kelvin to degrees centigrade.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">deg_C</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">:</span><span class="n">idx_troposphereboundaryline</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

        <span class="c"># Saturated water vapor pressure</span>
        <span class="n">vapor_pressure</span> <span class="o">=</span> <span class="mf">6.112</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="p">(</span><span class="mf">17.67</span> <span class="o">*</span> <span class="n">temperature</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">temperature</span> <span class="o">+</span> <span class="mf">243.15</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Add units of measurement.</span>
        <span class="n">vapor_pressure</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">hPa</span>

        <span class="k">return</span> <span class="n">vapor_pressure</span>

    <span class="k">def</span> <span class="nf">mixing_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">vapor_pressure</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is solely utilised for integration in the</span>
<span class="sd">        amsimp.Water.precipitable_water() method. Please do not interact with</span>
<span class="sd">        the method directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.622</span> <span class="o">*</span> <span class="n">vapor_pressure</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pressure</span> <span class="o">-</span> <span class="n">vapor_pressure</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">precipitable_water</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sum_altitude</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a NumPy array of saturated precipitable water vapor.</span>
<span class="sd">        Precipitable water is the total atmospheric water vapor contained in a</span>
<span class="sd">        vertical column of unit cross-sectional area extending between any two</span>
<span class="sd">        specified levels. For a contour plot of this data, please use the</span>
<span class="sd">        amsimp.Water.contourf() method. If sum_altitude is equal to True, </span>
<span class="sd">        it will sum the altitude component making the output 2-dimensional.</span>

<span class="sd">        Equation:</span>
<span class="sd">            PW = frac{1}{rho \* g} \* \int r dp</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure sum_altitude is a boolean value.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sum_altitude</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;sum_altitude must be a boolean value. The value of which was: {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">sum_altitude</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c"># Average boundary line between the troposphere and the stratosphere.</span>
        <span class="n">troposphere_boundaryline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troposphere_boundaryline</span><span class="p">()</span>
        <span class="n">avg_tropstratline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">troposphere_boundaryline</span><span class="p">)</span>
        <span class="n">idx_troposphereboundaryline</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">avg_tropstratline</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Defining some variables.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">Pa</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="n">pressure</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">:</span><span class="n">idx_troposphereboundaryline</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">vapor_pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">Pa</span><span class="p">)</span>
        <span class="n">vapor_pressure</span> <span class="o">=</span> <span class="n">vapor_pressure</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">g</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">rho_w</span> <span class="o">=</span> <span class="mf">997</span>

        <span class="c"># Integrate the mixing ratio with respect to pressure between the</span>
        <span class="c"># pressure boundaries of p1, and p2.</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_precipitablewater</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">pwv_lat</span><span class="p">,</span> <span class="nf">pwv_alt</span>
        <span class="k">cdef</span> <span class="kt">tuple</span> <span class="nf">integration_term</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">p1</span><span class="p">,</span> <span class="nf">p2</span><span class="p">,</span> <span class="nf">e</span><span class="p">,</span> <span class="nf">P_wv</span><span class="p">,</span> <span class="nf">Pwv_intergrationterm</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_pressurelong</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_pressurelat</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_pressurealt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span> <span class="o">-</span> <span class="mf">1</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">k</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_pressurelong</span><span class="p">:</span>
            <span class="n">pwv_lat</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">n</span> <span class="o">=</span> <span class="mf">0</span>
            <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_pressurelat</span><span class="p">:</span>
                <span class="n">pwv_alt</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">k</span> <span class="o">=</span> <span class="mf">0</span>
                <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">len_pressurealt</span><span class="p">:</span>
                    <span class="n">p1</span> <span class="o">=</span> <span class="n">pressure</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">p2</span> <span class="o">=</span> <span class="n">pressure</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">][</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">vapor_pressure</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">vapor_pressure</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">][</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2</span>

                    <span class="n">integration_term</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">e</span><span class="p">,))</span>
                    <span class="n">Pwv_intergrationterm</span> <span class="o">=</span> <span class="n">integration_term</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
                    <span class="n">pwv_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pwv_intergrationterm</span><span class="p">)</span>

                    <span class="n">k</span> <span class="o">+=</span> <span class="mf">1</span>

                <span class="k">if</span> <span class="n">sum_altitude</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                    <span class="n">pwv_lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwv_alt</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">P_wv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pwv_alt</span><span class="p">)</span>
                    <span class="n">pwv_lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P_wv</span><span class="p">)</span>                   

                <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
            
            <span class="n">list_precipitablewater</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwv_lat</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span>

        <span class="n">precipitable_water</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_precipitablewater</span><span class="p">)</span>

        <span class="c"># Multiplication term by integration.</span>
        <span class="n">precipitable_water</span> <span class="o">*=</span> <span class="mf">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho_w</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span>

        <span class="n">precipitable_water</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span>
        <span class="n">precipitable_water</span> <span class="o">=</span> <span class="n">precipitable_water</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">mm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">precipitable_water</span>

    <span class="k">def</span> <span class="nf">water_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots precipitable water on a contour plot, with the axes being</span>
<span class="sd">        latitude and longitude. This plot is then layed on top of a EckertIII</span>
<span class="sd">        global projection. For the raw data, please use the</span>
<span class="sd">        amsimp.Water.precipitable_water() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Defines the axes, and the data.</span>
        <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">precipitable_water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precipitable_water</span><span class="p">(</span>
            <span class="n">sum_altitude</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>

        <span class="c"># EckertIII projection details.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

        <span class="c"># Contourf plotting.</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="n">precipitable_water</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="n">precipitable_water</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">longitude</span><span class="p">,</span>
            <span class="n">latitude</span><span class="p">,</span>
            <span class="n">precipitable_water</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c"># Add SALT.</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Precipitable Water (&quot;</span>
         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
        <span class="p">)</span>

        <span class="c"># Colorbar creation.</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Precipitable Water (mm)&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="dynamics-class">
<h2>Dynamics Class<a class="headerlink" href="#dynamics-class" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">#cython: linetrace=True</span>
<span class="c">#distutils: define_macros=CYTHON_TRACE_NOGIL=1</span>
<span class="c">#cython: language_level=3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">AMSIMP Dynamics Class. For information about this class is described below.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>

<span class="c"># Importing Dependencies</span>
<span class="k">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">timedelta</span>
<span class="k">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">style</span>
<span class="k">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="k">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">ticker</span>
<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">from</span> <span class="nn">pynverse</span> <span class="k">import</span> <span class="n">inversefunc</span>
<span class="k">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">curve_fit</span>
<span class="k">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="k">from</span> <span class="nn">amsimp.wind</span> <span class="k">cimport</span> <span class="n">Wind</span>
<span class="k">from</span> <span class="nn">amsimp.wind</span> <span class="k">import</span> <span class="n">Wind</span>
<span class="k">from</span> <span class="nn">amsimp.water</span> <span class="k">cimport</span> <span class="n">Water</span>
<span class="k">from</span> <span class="nn">amsimp.water</span> <span class="k">import</span> <span class="n">Water</span>
<span class="k">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">r2_score</span>

<span class="c"># -----------------------------------------------------------------------------------------#</span>


<span class="k">cdef</span> <span class="k">class</span> <span class="nf">Dynamics</span><span class="p">(</span><span class="n">Water</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AMSIMP Dynamics Class - Also, known as Motus Aeris @ AMSIMP. This class</span>
<span class="sd">    generates rudimentary simulation of tropospheric and stratsopheric</span>
<span class="sd">    dynamics on a synoptic scale. Predictions are made by numerically</span>
<span class="sd">    solving the Primitive Equations (they are PDEs). The initial conditions</span>
<span class="sd">    are defined in the class methods of Water, Wind, and Backend. For more</span>
<span class="sd">    information on the initial conditions, please see those classes. The</span>
<span class="sd">    boundary conditions are handled by the gradient function between</span>
<span class="sd">    NumPy.</span>

<span class="sd">    Below is a list of the methods included within this class, with a short</span>
<span class="sd">    description of their intended purpose. Please see the relevant class methods</span>
<span class="sd">    for more information.</span>

<span class="sd">    forecast_temperature ~ this method outputs the forecasted temperature</span>
<span class="sd">    for the specified number of forecast days. Every single day is divided</span>
<span class="sd">    into hours, meaning the length of the outputted list is 24 times the number</span>
<span class="sd">    of forecast days specified.</span>
<span class="sd">    forecast_density ~ this method outputs the forecasted atmospheric</span>
<span class="sd">    density for the specified number of forecast days. Every single day is</span>
<span class="sd">    divided into hours, meaning the length of the outputted list is 24 times the</span>
<span class="sd">    number of forecast days specified.</span>
<span class="sd">    forecast_pressure ~ this method outputs the forecasted atmospheric</span>
<span class="sd">    pressure for the specified number of forecast days. Every single day is</span>
<span class="sd">    divided into hours, meaning the length of the outputted list is 24 times the</span>
<span class="sd">    number of forecast days specified.</span>
<span class="sd">    forecast_pressurethickness ~ this method outputs the forecasted pressure</span>
<span class="sd">    thickness for the specified number of forecast days. Every single day is</span>
<span class="sd">    divided into hours, meaning the length of the outputted list is 24 times the</span>
<span class="sd">    number of forecast days specified.</span>
<span class="sd">    forecast_precipitablewater ~ this method outputs the forecasted precipitable</span>
<span class="sd">    water for the specified number of forecast days. Every single day is divided</span>
<span class="sd">    into hours, meaning the length of the outputted list is 24 times the number</span>
<span class="sd">    of forecast days specified.</span>

<span class="sd">    simulate ~ this method outputs a visualisation of how temperature, pressure</span>
<span class="sd">    thickness, geostrophic wind, and precipitable water vapor will evolve for</span>
<span class="sd">    the specified number of forecast days.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">detail_level</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span> <span class="nb">int</span> <span class="n">forecast_days</span><span class="o">=</span><span class="mf">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines the number of days that will be included within the simulation.</span>
<span class="sd">        This value must be greater than 0, and less than 5 in order</span>
<span class="sd">        to ensure that the simulation methods function correctly. Defaults to</span>
<span class="sd">        a value of 3.</span>

<span class="sd">        For more information, please refer to amsimp.Backend.__cinit__()</span>
<span class="sd">        method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Declare class variables.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">detail_level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span> <span class="o">=</span> <span class="n">forecast_days</span>

        <span class="c"># Ensure self.forecast_days is between 0 and 10.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span> <span class="o">&gt;</span> <span class="mf">5</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s">&quot;forecast_days must be a positive integer between 1 and 5. The value of forecast_days was: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">delta_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines delta_x (the distance in metres between lines</span>
<span class="sd">        of latitude), delta_y (the distance in metres between</span>
<span class="sd">        lines of longitude), and delta_z (the distance between</span>
<span class="sd">        altitude levels). Please do not interact with</span>
<span class="sd">        the method directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># delta_x</span>
        <span class="c"># Distance between longitude lines at the equator.</span>
        <span class="k">cdef</span> <span class="nf">eq_longd</span> <span class="o">=</span> <span class="mf">111.19</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">km</span>
        <span class="n">eq_longd</span> <span class="o">=</span> <span class="n">eq_longd</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="c"># Distance of one degree of longitude (e.g. 0W - 1W/1E), measured in metres.</span>
        <span class="c"># The distance between two lines of longitude is not constant.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">long_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">())</span> <span class="o">*</span> <span class="n">eq_longd</span>
        <span class="c"># Distance between latitude lines in the class method,</span>
        <span class="c"># amsimp.Backend.latitude_lines().</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">delta_x</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">long_d</span>
        <span class="c"># Defining a 3D longitudinal distance NumPy array.</span>
        <span class="n">delta_x</span> <span class="o">=</span> <span class="n">delta_x</span><span class="o">.</span><span class="n">value</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">long_alt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_altitude</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_x</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len_altitude</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">long_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_deltax</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_longitudelines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">())</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_longitudelines</span><span class="p">:</span>
            <span class="n">list_deltax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">long_alt</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>
        <span class="n">delta_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_deltax</span><span class="p">)</span>
        <span class="n">delta_x</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span>

        <span class="c"># delta_y</span>
        <span class="c"># Distance of one degree of latitude (e.g. 0N - 1N/1S), measured in metres.</span>
        <span class="k">cdef</span> <span class="nf">lat_d</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mf">360</span>
        <span class="c"># Distance between latitude lines in the class method, </span>
        <span class="c"># amsimp.Backend.latitude_lines().</span>
        <span class="k">cdef</span> <span class="nf">delta_y</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">()[</span><span class="o">-</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">lat_d</span>

        <span class="c"># delta_z</span>
        <span class="k">cdef</span> <span class="nf">delta_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="mf">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">delta_x</span><span class="p">,</span> <span class="n">delta_y</span><span class="p">,</span> <span class="n">delta_z</span>

    <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">forecast_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utilising the initial conditions as defined by </span>
<span class="sd">        amsimp.Backend.temperature() and the temperature primitive</span>
<span class="sd">        equation, this method generates a forecast for temperature</span>
<span class="sd">        for the specified number of days. The finite difference </span>
<span class="sd">        method is utilised to get a numerical solution to the</span>
<span class="sd">        partial derivative equation. The value of delta t (the</span>
<span class="sd">        change in time) is one minute. The time interval between</span>
<span class="sd">        two elements in the outputted list is one hour.</span>

<span class="sd">        Equation:</span>
<span class="sd">        frac{\partial T}{\partial t} = u \* frac{\partial T}{\partial x} +</span>
<span class="sd">                                       v \* frac{\partial T}{\partial y} +</span>
<span class="sd">                                       w \* frac{\partial T}{\partial z}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Define the forecast period.</span>
        <span class="n">forecast_days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mf">0</span><span class="p">,</span> <span class="n">forecast_days</span><span class="p">,</span> <span class="p">(</span><span class="n">forecast_days</span> <span class="o">*</span> <span class="mf">1440</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Define the initial temperature condition.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span>

        <span class="c"># Define delta_x, delta_y, and delta_y.</span>
        <span class="n">delta_xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_xyz</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">delta_x</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_y</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_z</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

        <span class="c"># Define delta_t</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="n">delta_xval</span> <span class="o">=</span> <span class="n">delta_x</span><span class="o">.</span><span class="n">value</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">delta_t</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Define the zonal, meridional, and vertical wind velocities.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonal_wind</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meridional_wind</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Calculate how temperature will evolve over time.</span>
        <span class="n">forecast_temperature</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">temperature_gradient</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature_gradientx</span><span class="p">,</span> <span class="nf">temperature_gradienty</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">temperature_gradientz</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
            <span class="c"># Define the temperature gradient.</span>
            <span class="n">temperature_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

            <span class="c"># Define the temperature gradient in the longitude, latitude, and</span>
            <span class="c"># altitude directions.</span>
            <span class="n">temperature_gradientx</span> <span class="o">=</span> <span class="n">temperature_gradient</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
            <span class="n">temperature_gradienty</span> <span class="o">=</span> <span class="n">temperature_gradient</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
            <span class="n">temperature_gradientz</span> <span class="o">=</span> <span class="n">temperature_gradient</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

            <span class="c"># Calculate how temperature at a particular point in time.</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temperature</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">temperature_gradientx</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_y</span><span class="p">)</span> <span class="o">*</span> <span class="n">temperature_gradienty</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_z</span><span class="p">)</span> <span class="o">*</span> <span class="n">temperature_gradientz</span>
            <span class="p">)</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c"># Store the data within a list.</span>
            <span class="n">forecast_temperature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        
        <span class="n">forecast_temperature</span> <span class="o">=</span> <span class="n">forecast_temperature</span><span class="p">[::</span><span class="mf">60</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">forecast_temperature</span>

    <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">forecast_density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utilising the initial conditions as defined by </span>
<span class="sd">        amsimp.Backend.density() and the mass continunity</span>
<span class="sd">        equation, this method generates a forecast for atmospheric </span>
<span class="sd">        denisty for the specified number of days. The finite difference </span>
<span class="sd">        method is utilised to get a numerical solution to the</span>
<span class="sd">        partial derivative equation. The value of delta t (the</span>
<span class="sd">        change in time) is one minute. The time interval between</span>
<span class="sd">        two elements in the outputted list is one hour.</span>

<span class="sd">        Equation:</span>
<span class="sd">        frac{\partial rho}{\partial t} = - frac{\partial rho u}{\partial x} -</span>
<span class="sd">                                        frac{\partial rho v}{\partial y} -</span>
<span class="sd">                                        frac{\partial rho w}{\partial z}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Define the forecast period.</span>
        <span class="n">forecast_days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mf">0</span><span class="p">,</span> <span class="n">forecast_days</span><span class="p">,</span> <span class="p">(</span><span class="n">forecast_days</span> <span class="o">*</span> <span class="mf">1440</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Define the initial atmospheric density conditions.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>

        <span class="c"># Define delta_x, delta_y, and delta_y.</span>
        <span class="n">delta_xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_xyz</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">delta_x</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_y</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_z</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

        <span class="c"># Define delta_t</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="n">delta_xval</span> <span class="o">=</span> <span class="n">delta_x</span><span class="o">.</span><span class="n">value</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">delta_t</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Define the zonal, meridional, and vertical wind velocities.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonal_wind</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meridional_wind</span><span class="p">()</span>
        <span class="n">u_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">u_gradientx</span> <span class="o">=</span> <span class="n">u_gradient</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="n">v_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">v_gradienty</span> <span class="o">=</span> <span class="n">v_gradient</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Calculate how atmospheric density will evolve over time.</span>
        <span class="n">forecast_density</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">density_gradient</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">density_gradientx</span><span class="p">,</span> <span class="nf">density_gradienty</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">density_gradientz</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
            <span class="c"># Define the atmospheric density gradient.</span>
            <span class="n">density_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">density</span><span class="p">)</span>

            <span class="c"># Define the atmospheric density gradient in the longitude,</span>
            <span class="c"># latitude, and altitude directions.</span>
            <span class="n">density_gradientx</span> <span class="o">=</span> <span class="n">density_gradient</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
            <span class="n">density_gradienty</span> <span class="o">=</span> <span class="n">density_gradient</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
            <span class="n">density_gradientz</span> <span class="o">=</span> <span class="n">density_gradient</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

            <span class="c"># Calculate how atmospheric density at a particular point in time.</span>
            <span class="n">rho_leftdright</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">u_gradientx</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_y</span><span class="p">)</span> <span class="o">*</span> <span class="n">v_gradienty</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_z</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span>
            <span class="p">)</span>
            <span class="n">rho_rightdleft</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">density_gradientx</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_y</span><span class="p">)</span> <span class="o">*</span> <span class="n">density_gradienty</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_z</span><span class="p">)</span> <span class="o">*</span> <span class="n">density_gradientz</span>
            <span class="p">)</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">density</span> <span class="o">+</span> <span class="n">rho_leftdright</span> <span class="o">+</span> <span class="n">rho_rightdleft</span>
            <span class="n">density</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c"># Store the data within a list.</span>
            <span class="n">forecast_density</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
        
        <span class="n">forecast_density</span> <span class="o">=</span> <span class="n">forecast_density</span><span class="p">[::</span><span class="mf">60</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">forecast_density</span>
    
    <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">forecast_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utilising the forecasted temperature as defined by</span>
<span class="sd">        amsimp.Dynamics.forecast_temperature() and the atmospheric</span>
<span class="sd">        density as defined by amsimp.Dynamics.forecast_density(), </span>
<span class="sd">        this method generates a forecast for atmospheric pressure for </span>
<span class="sd">        the specified number of days using the ideal gas law.</span>

<span class="sd">        Equation:</span>
<span class="sd">            \del \cdot rho = 0</span>
<span class="sd">            p = rho \* R \* T</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Store the forecasted temperature and atmospheric</span>
        <span class="c"># densituy in a variable.</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">forecast_temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_temperature</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">forecast_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_density</span><span class="p">()</span>

        <span class="c"># Generate a forecast for pressure for the specified number of</span>
        <span class="c"># days.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">forecast_p</span>
        <span class="n">forecast_pressure</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">len_temprho</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">forecast_temperature</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len_temprho</span><span class="p">:</span>
            <span class="n">forecast_p</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">forecast_density</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">forecast_temperature</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">forecast_p</span> <span class="o">=</span> <span class="n">forecast_p</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">hPa</span><span class="p">)</span>

            <span class="n">forecast_pressure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forecast_p</span><span class="p">)</span>

            <span class="n">n</span> <span class="o">+=</span> <span class="mf">1</span>

        <span class="k">return</span> <span class="n">forecast_pressure</span>

    <span class="k">cpdef</span> <span class="nf">fit_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is solely utilised for non-linear regression in the</span>
<span class="sd">        amsimp.Dynamics.forecast_pressurethickness() method. Please do not</span>
<span class="sd">        interact with the method directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>

    <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">forecast_pressurethickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="mf">1000</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">500</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utilising the forecasted pressure as defined by </span>
<span class="sd">        amsimp.Dynamics.forecast_pressure() and utilising non-linear</span>
<span class="sd">        regression, similiar to the amsimp.Backend.pressure_thickness()</span>
<span class="sd">        method, this method generates a forecast of the atmospheric </span>
<span class="sd">        pressure thickness between two constant pressure surfaces, p1 and</span>
<span class="sd">        p2. For more information on the forecasted pressure, please see</span>
<span class="sd">        amsimp.Dynamics.forecast_pressure()</span>

<span class="sd">        Equation:</span>
<span class="sd">            y = a - frac{b}{c} * (1 - \exp(-c * x))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure p1 is greater than p2.</span>
        <span class="k">if</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="n">p2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Please note that p1 must be greater than p2.&quot;</span><span class="p">)</span>

        <span class="c"># Store the forecasted pressure in a variable.</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">forecast_pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_pressure</span><span class="p">()</span>
        
        <span class="c"># Find the nearest constant pressure surface to p1 and p2 in pressure.</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">indx_p1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast_pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">indx_p2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast_pressure</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="c"># Find the approximate altitude of the constant pressure surfaces</span>
        <span class="c"># p1 and p2. Following which, take away 5400 from the p1 values </span>
        <span class="c"># and add 1000 to the p2 value.</span>
        <span class="n">approx_p1_alt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="n">indx_p1</span><span class="p">]</span>
        <span class="n">approx_p2_alt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="n">indx_p2</span><span class="p">]</span>
        <span class="n">approx_p1_alt</span> <span class="o">-=</span> <span class="mf">5400</span>
        <span class="n">approx_p2_alt</span> <span class="o">+=</span> <span class="mf">2000</span>

        <span class="n">indx_p1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">approx_p1_alt</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="n">indx_p2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">approx_p2_alt</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span> 

        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">altitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="n">indx_p1</span><span class="p">:</span><span class="n">indx_p2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        
        <span class="n">forecast_pressurethickness</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">forecast_p</span><span class="p">,</span> <span class="nf">pressure_thickness</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">p</span><span class="p">,</span> <span class="nf">p_lat</span><span class="p">,</span> <span class="nf">abc</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">list_pressurethickness</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">r_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1000</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">pthickness_lat</span>
        <span class="k">cdef</span> <span class="kt">tuple</span> <span class="nf">c</span>
        <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">p1_height</span><span class="p">,</span> <span class="nf">p2_height</span><span class="p">,</span> <span class="nf">pthickness</span><span class="p">,</span> <span class="nf">r_value</span>
        <span class="k">for</span> <span class="n">forecast_p</span> <span class="ow">in</span> <span class="n">forecast_pressure</span><span class="p">:</span>
            <span class="n">forecast_p</span> <span class="o">=</span> <span class="n">forecast_p</span><span class="o">.</span><span class="n">value</span>

            <span class="n">list_pressurethickness</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">forecast_p</span><span class="p">:</span>
                <span class="n">pthickness_lat</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">p_lat</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                    <span class="n">p_lat</span> <span class="o">=</span> <span class="n">p_lat</span><span class="p">[</span><span class="n">indx_p1</span><span class="p">:</span><span class="n">indx_p2</span><span class="p">]</span>

                    <span class="n">c</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">p_lat</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>
                    <span class="n">abc</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>

                    <span class="n">predicted_pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">(</span>
                        <span class="n">altitude</span><span class="p">,</span> <span class="n">abc</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">r_value</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
                        <span class="n">predicted_pressure</span><span class="p">,</span> <span class="n">p_lat</span>
                    <span class="p">)</span>
                    <span class="n">r_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>

                    <span class="n">inverse_fitmethod</span> <span class="o">=</span> <span class="n">inversefunc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_method</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">abc</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">abc</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span>
                    <span class="p">)</span>

                    <span class="n">p1_height</span> <span class="o">=</span> <span class="n">inverse_fitmethod</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
                    <span class="n">p2_height</span> <span class="o">=</span> <span class="n">inverse_fitmethod</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
                    <span class="n">pthickness</span> <span class="o">=</span> <span class="n">p2_height</span> <span class="o">-</span> <span class="n">p1_height</span>

                    <span class="n">pthickness_lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pthickness</span><span class="p">)</span>
                <span class="n">list_pressurethickness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pthickness_lat</span><span class="p">)</span>
            
            <span class="n">pressure_thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_pressurethickness</span><span class="p">)</span>
            <span class="n">pressure_thickness</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span>
            <span class="n">forecast_pressurethickness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pressure_thickness</span><span class="p">)</span>

        <span class="c"># Ensure the R^2 value is greater than 0.9.</span>
        <span class="n">r_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r_value</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Unable to determine the pressure thickness&quot;</span>
            <span class="o">+</span> <span class="s">&quot; at this time. Please contact the developer for futher&quot;</span>
            <span class="o">+</span> <span class="s">&quot; assistance.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">forecast_pressurethickness</span>

    <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">forecast_precipitablewater</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utilising the initial conditions as defined by </span>
<span class="sd">        amsimp.Backend.precipitable_water() and the precipitable water</span>
<span class="sd">        primitive equation, this method generates a forecast for precipitable</span>
<span class="sd">        water for the specified number of days. The finite difference </span>
<span class="sd">        method is utilised to get a numerical solution to the partial</span>
<span class="sd">        derivative equation. The value of delta t (the change in time) is</span>
<span class="sd">        one minute. The time interval between two elements in the outputted</span>
<span class="sd">        list is one hour.</span>

<span class="sd">        Equation:</span>
<span class="sd">        frac{\partial W}{\partial t} = u \* frac{\partial W}{\partial x} +</span>
<span class="sd">                                       v \* frac{\partial W}{\partial y} +</span>
<span class="sd">                                       w \* frac{\partial W}{\partial z}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Define the forecast period.</span>
        <span class="n">forecast_days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mf">0</span><span class="p">,</span> <span class="n">forecast_days</span><span class="p">,</span> <span class="p">(</span><span class="n">forecast_days</span> <span class="o">*</span> <span class="mf">1440</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Define the initial precipitable water condition.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">precipitable_water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precipitable_water</span><span class="p">(</span>
            <span class="n">sum_altitude</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>

        <span class="c"># Define delta_x, delta_y, and delta_y.</span>
        <span class="n">delta_xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_xyz</span><span class="p">()</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">delta_x</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mf">40</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_y</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="nf">delta_z</span> <span class="o">=</span> <span class="n">delta_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

        <span class="c"># Define delta_t</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
        <span class="n">delta_xval</span> <span class="o">=</span> <span class="n">delta_x</span><span class="o">.</span><span class="n">value</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_xval</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">delta_t</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">day</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta_t</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Define the zonal, meridional, and vertical wind velocities.</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonal_wind</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mf">40</span><span class="p">]</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meridional_wind</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mf">40</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Calculate how precipitable water will evolve over time.</span>
        <span class="n">forecast_precipitablewater</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">pwv_gradient</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">pwv_gradientx</span><span class="p">,</span> <span class="nf">pwv_gradienty</span><span class="p">,</span> <span class="nf">pwv_gradientz</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
            <span class="c"># Define the precipitable water gradient.</span>
            <span class="n">pwv_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">precipitable_water</span><span class="p">)</span>

            <span class="c"># Define the precipitable water gradient in the longitude,</span>
            <span class="c"># latitude, and altitude directions.</span>
            <span class="n">pwv_gradientx</span> <span class="o">=</span> <span class="n">pwv_gradient</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
            <span class="n">pwv_gradienty</span> <span class="o">=</span> <span class="n">pwv_gradient</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
            <span class="n">pwv_gradientz</span> <span class="o">=</span> <span class="n">pwv_gradient</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>

            <span class="c"># Calculate how temperature at a particular point in time.</span>
            <span class="n">pwv</span> <span class="o">=</span> <span class="n">precipitable_water</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_x</span><span class="p">)</span> <span class="o">*</span> <span class="n">pwv_gradientx</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_y</span><span class="p">)</span> <span class="o">*</span> <span class="n">pwv_gradienty</span>
            <span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t</span> <span class="o">/</span> <span class="n">delta_z</span><span class="p">)</span> <span class="o">*</span> <span class="n">pwv_gradientz</span>
            <span class="p">)</span>
            <span class="n">precipitable_water</span> <span class="o">=</span> <span class="n">pwv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c"># Sum by the altitude component.</span>
            <span class="n">pwv_output</span> <span class="o">=</span> <span class="n">pwv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">list_pwv</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">pwv_long</span> <span class="ow">in</span> <span class="n">pwv_output</span><span class="p">:</span>
                <span class="n">list_pwvlat</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">pwv_lat</span> <span class="ow">in</span> <span class="n">pwv_long</span><span class="p">:</span>
                    <span class="n">pwv_alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pwv_lat</span><span class="p">)</span>
                    <span class="n">list_pwvlat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwv_alt</span><span class="p">)</span>
                <span class="n">list_pwv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_pwvlat</span><span class="p">)</span>
            <span class="n">pwv_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">list_pwv</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">mm</span>

            <span class="c"># Store the predicted amount of precipitable water into a list.</span>
            <span class="n">forecast_precipitablewater</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwv_output</span><span class="p">)</span>

        <span class="n">forecast_precipitablewater</span> <span class="o">=</span> <span class="n">forecast_precipitablewater</span><span class="p">[::</span><span class="mf">60</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">forecast_precipitablewater</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method outputs a visualisation of how temperature, pressure</span>
<span class="sd">        thickness, atmospheric pressure, and precipitable water vapor will </span>
<span class="sd">        evolve. The atmospheric pressure and precipitable water elements of</span>
<span class="sd">        this visualisation operate similarly to the method, </span>
<span class="sd">        amsimp.Backend.longitude_contourf(), so, please refer to this method for</span>
<span class="sd">        a detailed description of the aforementioned elements. Likewise, please</span>
<span class="sd">        refer to amsimp.Water.water_contourf() for more information on the</span>
<span class="sd">        visualisation element of precipitable water vapor, or to</span>
<span class="sd">        amsimp.Backend.altitude_contourf() for more information on the</span>
<span class="sd">        visualisation element of temperature.</span>

<span class="sd">        For a visualisation of geostrophic wind (zonal and meridional</span>
<span class="sd">        components), please refer to the amsimp.Wind.wind_contourf(), or</span>
<span class="sd">        amsimp.Wind.globe() methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Define the forecast period.</span>
        <span class="n">forecast_days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forecast_days</span><span class="p">)</span>
        <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mf">0</span><span class="p">,</span> <span class="n">forecast_days</span><span class="p">,</span> <span class="p">(</span><span class="n">forecast_days</span> <span class="o">*</span> <span class="mf">24</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># Style of graph.</span>
        <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&quot;fivethirtyeight&quot;</span><span class="p">)</span>

        <span class="c"># Define layout.</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.340</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.105</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.905</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

        <span class="c"># Temperature</span>
        <span class="n">indx_long</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span>
        <span class="n">forecast_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_temperature</span><span class="p">()</span>
        <span class="c"># Atmospheric Pressure</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">forecast_pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_pressure</span><span class="p">()</span>
        <span class="c"># Precipitable Water</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">forecast_Pwv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_precipitablewater</span><span class="p">()</span>
        <span class="c"># Pressure Thickness (1000hPa - 500hPa).</span>
        <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EckertIII</span><span class="p">())</span>
        <span class="n">forecast_pthickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast_pressurethickness</span><span class="p">()</span>

        <span class="c"># Troposphere - Stratosphere Boundary Line</span>
        <span class="n">trop_strat_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troposphere_boundaryline</span><span class="p">()</span>
        <span class="n">trop_strat_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trop_strat_line</span><span class="o">.</span><span class="n">value</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">trop_strat_line</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="mf">0</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
            <span class="c"># Defines the axes.</span>
            <span class="c"># For the temperature contour plot.</span>
            <span class="n">latitude</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="c"># For the pressure, precipitable water, and pressure </span>
            <span class="c"># thickness countour plot</span>
            <span class="n">lat</span><span class="p">,</span> <span class="nb">long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">latitude_lines</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude_lines</span><span class="p">()</span>
            <span class="p">)</span>
            
            <span class="c"># Temperature contour plot.</span>
            <span class="c"># Temperature data.</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">forecast_temp</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span><span class="p">[</span><span class="n">indx_long</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

            <span class="c"># Contour plotting.</span>
            <span class="n">cmap1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>
            <span class="n">min1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">forecast_temp</span><span class="p">)</span>
            <span class="n">max1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">forecast_temp</span><span class="p">)</span>
            <span class="n">level1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min1</span><span class="p">,</span> <span class="n">max1</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="n">latitude</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap1</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">level1</span>
            <span class="p">)</span>

            <span class="c"># Checks for a colorbar.</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
                <span class="n">cb1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
                <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
                <span class="n">cb1</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
                <span class="n">cb1</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
                <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Temperature (K)&quot;</span><span class="p">)</span>

            <span class="c"># Add SALT to the graph.</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;Altitude (m)&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Temperature&quot;</span><span class="p">)</span>

            <span class="c"># Atmospheric pressure contour.</span>
            <span class="c"># Pressure data.</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="n">forecast_pressure</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="n">pressure</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">]</span>

            <span class="c"># EckertIII projection details.</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

            <span class="c"># Contourf plotting.</span>
            <span class="n">pressure_sealevel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">forecast_pressure</span><span class="p">)</span>
            <span class="n">pressure_sealevel</span> <span class="o">=</span> <span class="n">pressure_sealevel</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">]</span>
            <span class="n">cmap2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;jet&quot;</span><span class="p">)</span>
            <span class="n">min2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pressure_sealevel</span><span class="p">)</span>
            <span class="n">max2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pressure_sealevel</span><span class="p">)</span>
            <span class="n">level2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min2</span><span class="p">,</span> <span class="n">max2</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
            <span class="n">atmospheric_pressure</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="nb">long</span><span class="p">,</span>
                <span class="n">lat</span><span class="p">,</span>
                <span class="n">pressure</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">level2</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="p">)</span>

            <span class="c"># Checks for a colorbar.</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
                <span class="n">cb2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">atmospheric_pressure</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
                <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
                <span class="n">cb2</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
                <span class="n">cb2</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
                <span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Pressure (hPa)&quot;</span><span class="p">)</span>

            <span class="c"># Add SALT to the graph.</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                <span class="s">&quot;Atmospheric Pressure (Alt = &quot;</span> 
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">altitude_level</span><span class="p">()[</span><span class="mf">0</span><span class="p">])</span>
                <span class="o">+</span> <span class="s">&quot;)&quot;</span>
            <span class="p">)</span>

            <span class="c"># Precipitable water contour.</span>
            <span class="c"># Precipitable water data.</span>
            <span class="n">precipitable_water</span> <span class="o">=</span> <span class="n">forecast_Pwv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

            <span class="c"># EckertIII projection details.</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

            <span class="c"># Contourf plotting.</span>
            <span class="n">cmap3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;seismic&quot;</span><span class="p">)</span>
            <span class="n">min3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">forecast_Pwv</span><span class="p">)</span>
            <span class="n">max3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">forecast_Pwv</span><span class="p">)</span>
            <span class="n">level3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min3</span><span class="p">,</span> <span class="n">max3</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
            <span class="n">precipitable_watervapour</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="nb">long</span><span class="p">,</span>
                <span class="n">lat</span><span class="p">,</span>
                <span class="n">precipitable_water</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap3</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">level3</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="p">)</span>

            <span class="c"># Checks for a colorbar.</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
                <span class="n">cb3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">precipitable_watervapour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
                <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
                <span class="n">cb3</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
                <span class="n">cb3</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
                <span class="n">cb3</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Precipitable Water (mm)&quot;</span><span class="p">)</span>

            <span class="c"># Add SALT to the graph.</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Precipitable Water&quot;</span><span class="p">)</span>

            <span class="c"># Pressure thickness scatter plot.</span>
            <span class="c"># Pressure thickness data.</span>
            <span class="n">pressure_thickness</span> <span class="o">=</span> <span class="n">forecast_pthickness</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

            <span class="c"># EckertIII projection details.</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

            <span class="c"># Contourf plotting.</span>
            <span class="n">min4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">forecast_pthickness</span><span class="p">)</span>
            <span class="n">max4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">forecast_pthickness</span><span class="p">)</span>
            <span class="n">level4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min4</span><span class="p">,</span> <span class="n">max4</span><span class="p">,</span> <span class="mf">21</span><span class="p">)</span>
            <span class="n">pressure_h</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="nb">long</span><span class="p">,</span>
                <span class="n">lat</span><span class="p">,</span>
                <span class="n">pressure_thickness</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">level4</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c"># Index of the rain / snow line</span>
            <span class="n">indx_snowline</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">level4</span> <span class="o">-</span> <span class="mf">5400</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
            <span class="n">pressure_h</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="n">indx_snowline</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
            <span class="n">pressure_h</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="n">indx_snowline</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span> 

            <span class="c"># Add SALT.</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;Latitude ($\phi$)&quot;</span><span class="p">)</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;Longitude ($\lambda$)&quot;</span><span class="p">)</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Thickness (1000 hPa - 500 hPa)&quot;</span><span class="p">)</span>

            <span class="c"># Checks for a colorbar.</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span>
                <span class="n">cb4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pressure_h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>
                <span class="n">tick_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
                <span class="n">cb4</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">tick_locator</span>
                <span class="n">cb4</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>
                <span class="n">cb4</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&quot;Pressure Thickness (m)&quot;</span><span class="p">)</span>

            <span class="c"># Plots the average boundary line on two contourfs.</span>
            <span class="c"># Temperature contourf.</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">latitude</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span>
                <span class="n">trop_strat_line</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s">&quot;Troposphere - Stratosphere Boundary Line&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>

            <span class="c"># Title of Simulation.</span>
            <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=+</span><span class="n">t</span><span class="p">)</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span>
            <span class="n">minute</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span>

            <span class="k">if</span> <span class="n">minute</span> <span class="o">&lt;</span> <span class="mf">10</span><span class="p">:</span>
                <span class="n">minute</span> <span class="o">=</span> <span class="s">&quot;0&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">minute</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minute</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">minute</span><span class="p">)</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
                <span class="s">&quot;Motus Aeris @ AMSIMP (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">hour</span><span class="p">)</span>
                <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">minute</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">-%m-%Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
            <span class="p">)</span>

            <span class="c"># Displaying simualtion.</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">ax4</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span>

            <span class="n">note</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s">&quot;Note: Geostrophic balance does not hold near the equator.&quot;</span>
                <span class="o">+</span> <span class="s">&quot; Rain / Snow Line is marked on the Pressure Thickness&quot;</span> 
                <span class="o">+</span> <span class="s">&quot; contour plot by the black line (5,400 m).&quot;</span>
            <span class="p">)</span>

            <span class="c"># Footnote</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span>
                <span class="mf">0.99</span><span class="p">,</span>
                <span class="mf">0.01</span><span class="p">,</span>
                <span class="n">note</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mf">10</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">t</span> <span class="o">+=</span> <span class="mf">1</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="math.html" title="previous chapter (use the left arrow)">Mathematics of AMSIMP</a>
      </div>
    
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="math.html" title="Mathematics of AMSIMP"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AMSIMP 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2020, Conor Casey. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>