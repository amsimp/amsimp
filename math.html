
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Mathematics &#8212; AMSIMP 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="refs.html" />
    <link rel="prev" title="Dynamical Core" href="core.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="refs.html" title="References"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Dynamical Core"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AMSIMP 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mathematics</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">Mathematics</a><ul>
<li><a class="reference internal" href="#pressure-thickness">Pressure Thickness</a></li>
<li><a class="reference internal" href="#precipitable-water">Precipitable Water</a></li>
<li><a class="reference internal" href="#virtual-temperature">Virtual Temperature</a></li>
<li><a class="reference internal" href="#primitive-equations">Primitive Equations</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="core.html"
                        title="previous chapter">Dynamical Core</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="refs.html"
                        title="next chapter">References</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/math.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="index.html">Docs</a></li>
              
              <li>Mathematics</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="mathematics">
<h1>Mathematics<a class="headerlink" href="#mathematics" title="Permalink to this headline">¶</a></h1>
<p>Not fully fleshed out, more details to be added.</p>
<div class="section" id="pressure-thickness">
<h2>Pressure Thickness<a class="headerlink" href="#pressure-thickness" title="Permalink to this headline">¶</a></h2>
<p>Pressure Thickness is the measurement of the distance (in metres)
between any two constant pressure surfaces.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="https://github.com/amsimp/papers/raw/master/scifest-online/project-book/Images/thickness_def.png"><img alt="Pressure Thickness Definition (provided by the NWS of the USA)" src="https://github.com/amsimp/papers/raw/master/scifest-online/project-book/Images/thickness_def.png" style="width: 95%;" /></a>
</div>
<p>One of the most common thickness charts used in meteorology is the
1000-500 hPa thickness, and for the purposes of this project, it will be
the sole interest. This is the distance between the elevation of the
1,000 hPa and 500 hPa levels. Typically, the 1,000 hPa surface is used
to represent sea level but this is just a generalisation. On pressure
charts, the last digit (zero) of a thickness value is typically
truncated. So, a 1000-500 thickness value of 570 means the distance
between the two surfaces is 5,700 metres. The 1000-500 hPa thickness
value of 540 is traditionally used to determine rain versus snow. If
precipitation is predicted poleward of this 540-thickness line (if the
thickness value is less than 540), it is expected that it will be snow.
If precipitation is predicted on the equator side of this line (if the
thickness value is greater than 540), then it is expected that the
precipitation will be in a liquid form. The reason one is able to make
such an expectation is due to the fact that the 540-thickness line
closely follows the surface freezing temperature of 273
K <a class="bibtex reference internal" href="refs.html#thickness" id="id1">[15]</a>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="https://github.com/amsimp/papers/raw/master/scifest-online/project-book/Images/rainsnow_line.png"><img alt="Rain/Snow Line (provided by the NWS of the USA)" src="https://github.com/amsimp/papers/raw/master/scifest-online/project-book/Images/rainsnow_line.png" style="width: 95%;" /></a>
</div>
<p>To determine the pressure thickness between two constant pressure
surfaces, the Hypsometric equation is utilised and as shown in equation
<a class="reference internal" href="#equation-hypsometric">(1)</a>.</p>
<p>The hypsometric equation relates an atmospheric pressure ratio to the
equivalent thickness of an atmospheric layer considering the layer mean
of virtual temperature, gravity, and occasionally wind. It is derived
from the hydrostatic equation and the ideal gas law.</p>
<div class="math notranslate nohighlight" id="equation-hypsometric">
<span class="eqno">(1)<a class="headerlink" href="#equation-hypsometric" title="Permalink to this equation">¶</a></span>\[h = \Phi_2 - \Phi_1 = \frac{R \bar{T_v}}{g} \ln{\frac{p_1}{p_2}}\]</div>
</div>
<div class="section" id="precipitable-water">
<h2>Precipitable Water<a class="headerlink" href="#precipitable-water" title="Permalink to this headline">¶</a></h2>
<p>Precipitable Water is the total atmospheric water vapour contained in a
vertical column of unit cross-sectional area extending between any two
specified pressure levels.</p>
<p>Based on the definition, precipitable water can be described
mathematically as being:</p>
<div class="math notranslate nohighlight" id="equation-pwv-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-pwv-1" title="Permalink to this equation">¶</a></span>\[W = \int_{0}^{z} \rho_v dz\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_v\)</span> is the density of water vapour, and where
<span class="math notranslate nohighlight">\(\rho_v\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\rho_v = \frac{\texttt{mass of vapour}}{\texttt{unit volume}}\]</div>
<p>Following which, the hydrostatic equation can be applied to equation
<a class="reference internal" href="#equation-pwv-1">(2)</a> in order to replace <span class="math notranslate nohighlight">\(dz\)</span> with <span class="math notranslate nohighlight">\(dp\)</span>. The
reason for doing this is that atmospheric pressure is extremely easier
to measure, with devices such as weather balloons being readily
available.</p>
<div class="math notranslate nohighlight" id="equation-pwv-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-pwv-2" title="Permalink to this equation">¶</a></span>\[W = -\int_{p_1}^{p_2} \frac{\rho_v}{\rho g} dp\]</div>
<p>Where <span class="math notranslate nohighlight">\(p_1\)</span> and <span class="math notranslate nohighlight">\(p_2\)</span> are constant pressure surfaces, and
where <span class="math notranslate nohighlight">\(p_1 &gt; p_2\)</span>. Substituting in the definition of density,
<span class="math notranslate nohighlight">\(\rho_v = \frac{m_v}{V}; \rho = \frac{m_{air}}{V}\)</span>, into equation
<a class="reference internal" href="#equation-pwv-2">(3)</a> results in:</p>
<div class="math notranslate nohighlight">
\[W = -\int_{p_1}^{p_2} \frac{1}{g} \frac{m_v V}{m_{air} V} dp\]</div>
<div class="math notranslate nohighlight">
\[\Rightarrow W = - \frac{1}{g} \int_{p_1}^{p_2} \frac{m_v}{m_{air}} dp\]</div>
<p>The integration term in this particular equation is the definition for
the specific humidity, with the units of measurement being
<span class="math notranslate nohighlight">\(\frac{kg}{kg}\)</span>. The specific humidity can be approximated by the
mixing ratio, with an error typically around 4
% <a class="bibtex reference internal" href="refs.html#pwv-def" id="id2">[12]</a>.</p>
<p>Mixing Ratio is the ratio of the mass of a variable atmospheric
constituent to the mass of dry air.</p>
<div class="math notranslate nohighlight" id="equation-pwv-derive-fin">
<span class="eqno">(4)<a class="headerlink" href="#equation-pwv-derive-fin" title="Permalink to this equation">¶</a></span>\[\therefore W = -\frac{1}{g} \int_{p_1}^{p_2} m dp\]</div>
<p>The units as given by the equation are <span class="math notranslate nohighlight">\(\frac{kg}{m^2}\)</span>
(dimensionless), but, the preferred unit of measurement for rainfall is
<span class="math notranslate nohighlight">\(mm\)</span>. The conversion between the two units of measurements is one
to one (<span class="math notranslate nohighlight">\(1 \frac{kg}{m^2} = 1 mm\)</span>) In actual rainstorms,
particularly thunderstorms, amounts of rain very often exceed the total
precipitable water of the overlying atmosphere. This results from the
action of convergence that brings into the rainstorm the water vapour
from a surrounding area that is often quite large. Nevertheless, there
is general correlation between precipitation amounts in given storms and
the precipitable water of the air masses involved in those
storms <a class="bibtex reference internal" href="refs.html#problems-with-pwv" id="id3">[16]</a>.</p>
<p>For the purposes of numerically calculating the precipitable water for a
given column of air, equation :eq: pwv_derive_fin is
commonly rewritten as the following:</p>
<div class="math notranslate nohighlight" id="equation-pwv">
<span class="eqno">(5)<a class="headerlink" href="#equation-pwv" title="Permalink to this equation">¶</a></span>\[W = -\frac{1}{\rho g} \int_{p_1}^{p_2} \frac{0.622 e}{p - e} dp\]</div>
<p>Vapour Pressure is the pressure exerted by a vapour when the vapour is
in equilibrium with the liquid or solid form, or both, of the same
substance. In meteorology, vapour pressure is used almost exclusively to
denote the partial pressure of water vapour in the atmosphere.</p>
<p>Considering vapor pressure is not one of the three prognostic variables
defined in section, it is therefore necessary to express vapor pressure
in terms of the already defined variables. This can be done through the
utilisation of temperature and relative humidity. First, one must determine
the saturated vapour pressure. This can be done using the following
equation <a class="bibtex reference internal" href="refs.html#balton" id="id4">[2]</a>:</p>
<div class="math notranslate nohighlight">
\[e_s = 6.112 \exp(\frac{17.67 T}{T + 243.5})\]</div>
<p>After which, the vapor pressure can be calculated as follows:</p>
<div class="math notranslate nohighlight" id="equation-vapor-pressure-eq">
<span class="eqno">(6)<a class="headerlink" href="#equation-vapor-pressure-eq" title="Permalink to this equation">¶</a></span>\[e = \frac{e_{s} r}{100}\]</div>
<p>In wet periods, the precipitable water is particularly close to the
saturated precipitable water. In situations when the precipitable water
is close to the saturated precipitable water, the precipitable water
changes very little over the day. Saturated precipitable water also
makes calculations a whole lot simpler, as specific humidity data is
rather difficult to come by.</p>
<p>In regards to the numerical calculation of the precipitable water, the
SciPy method, scipy.integrate.quad, is utilised in order to determine
the definite integral in equation :eq: <cite>pwv</cite>. This method
integrates the function using a technique from the Fortran library,
QUADPACK <a class="bibtex reference internal" href="refs.html#scipy-integrate" id="id5">[14]</a>.</p>
</div>
<div class="section" id="virtual-temperature">
<span id="virtual-section"></span><h2>Virtual Temperature<a class="headerlink" href="#virtual-temperature" title="Permalink to this headline">¶</a></h2>
<p>The virtual temperature is the temperature at which dry air would have
the same density as the moist air, at a given pressure. In other words,
two air samples with the same virtual temperature have the same density,
regardless of their actual temperature or relative humidity. Because
water vapor is less dense than dry air and warm air is less dense than
cool air, the virtual temperature is always greater than or equal to the
actual temperature.</p>
<p>In relation to this project, the virtual temperature will be extremely
useful as it will allow for the calculation of the evolution of relative
humidity through the utilisation of the thermodynamic advection equation.
This is due to the fact that virtual temperature can be expressed in terms of
vapor pressure, which can be converted into relative humidity. This can
be seen as follows:</p>
<div class="math notranslate nohighlight">
\[T_v = \frac{T}{1 - \frac{0.378 e}{p}}\]</div>
<p>The equation becomes the following, by substituting equation
<a class="reference internal" href="#equation-vapor-pressure-eq">(6)</a> in and rearranging for
relative humidity:</p>
<div class="math notranslate nohighlight">
\[r = \frac{100 (p T_v - p T)}{0.378 e_s T_v}\]</div>
</div>
<div class="section" id="primitive-equations">
<h2>Primitive Equations<a class="headerlink" href="#primitive-equations" title="Permalink to this headline">¶</a></h2>
<p>To be added.</p>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="core.html" title="previous chapter (use the left arrow)">Dynamical Core</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="refs.html" title="next chapter (use the right arrow)">References</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="refs.html" title="References"
             >next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Dynamical Core"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">AMSIMP 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mathematics</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2020, AMSIMP. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>